# CLAUDE.md  
_Autonoums Development Guide for Claude Code_

## 1. プロジェクト概要
### 1-1. プロジェクト名
**Shuka – 秀歌（AI音楽アーティスト公式サイト）**

### 1-2. 目的・目標
- AI音楽アーティスト「Shuka – 秀歌」の公式Webサイト制作 ✅
- **Vibe Cording** の魅力と可能性をターゲットユーザーに伝える ✅
- 訪問者に驚きと印象的な体験を提供する ✅

### 1-3. 現在の状況
- **開発状況**: MVP完成済み
- **フェーズ**: メンテナンス・継続改善段階
- **次期目標**: 品質保証完了、継続的な機能改善

### 1-4. ターゲットユーザー
- **主要ターゲット**: Vibe Cording に興味を持つユーザー層
- **デバイス**: PC・スマートフォン両対応
- **想定行動**: 楽曲試聴、アーティスト情報確認、外部サービス（Suno AI、Note）への遷移

### 1-5. 技術要件
**バニラ HTML / CSS / JavaScript** で実装し、モバイルを含む主要ブラウザで快適に表示できるサイトを完成させる。  
**開発方針**: ソースファイルを直接使用し、ビルドプロセスは使用しない。  

---

## 2. 成果物スコープ
- `index.html` … LP 本体  
- `styles.css` … ページスタイル  
- `scripts.js` … ギャラリー切替・テーマ変更などのロジック  
- `three-lanterns.js` … Three.js 3D演出  
- `img/` … 画像ファイル
- `audio/` … 音声ファイル
- `video/` … 動画ファイル
   

> **柔軟性重視**  
> 適宜、この文書およびコードを**自律的に更新**して整合を保つこと。

---

## 4. 技術仕様
### 4-1. 基本構成
- **HTML5** … セマンティックマークアップ  
- **CSS3** … レスポンシブデザイン（Grid, Flexbox 活用）  
- **JavaScript** … ES6+ 記法  
- **外部ライブラリ** … Three.js（CDN経由）を視覚効果のために使用許可

#### ローカル起動メモ
- ビルド工程なし。プレビューは `npx http-server -c-1` を推奨（キャッシュ無効）。

#### Service Worker 運用
- `sw.js` は `VERSION` によりキャッシュ更新を制御（現在: `v4`）。
- `PRECACHE_URLS` は非 minified アセット（例: `/css/loader.css`, `/js/loader.js`）を対象とする。

### 4-2. レスポンシブ対応
- **モバイルファースト** 設計  
- ブレークポイント例:  
  - `~767px` … モバイル  
  - `768px~1023px` … タブレット  
  - `1024px~` … デスクトップ

### 4-3. ブラウザサポート
- Chrome, Firefox, Safari, Edge の最新版  
- iOS Safari, Chrome Mobile 対応必須

---

## 5. ページ構成・機能要件
### 5-1. コア機能（最高優先度）
#### 5-1-1. 季節演出システム
- **春**: 桜の花びら降下演出
- **夏**: 柳の葉が舞う降下演出
- **秋**: 紅葉降下演出
- **冬**: 雪降下演出
- **雨**: 雨滴演出（既存・満足度高）
- **切り替え方式**: 自動検知またはユーザー選択

#### 5-1-2. ギャラリーシステム
- **楽曲**: 8曲（完備済み）
- **動画**: 季節対応4曲（完備済み）
- **動画配置**: 最適化済み

### 5-2. セクション構成
1. **ヒーローセクション**: 季節演出 + キャッチビジュアル ✅
2. **アバウトセクション**: アーティスト紹介 ✅
3. **ギャラリーセクション**: 楽曲・動画（最適化配置） ✅
4. **リンクセクション**: Suno AI、Noteへの誘導 ✅
5. **フッター**: 著作権・追加情報 ✅

### 5-3. インタラクション機能
- **ギャラリー切替** … タブまたはフィルター
- **スムーススクロール** … アンカーリンク
- **季節演出切り替え** … 和風テイストの豪華な演出
- **特徴カードのホバー効果** … カードが浮き上がる影のみで位置は変化しない

### 5-4. パフォーマンス要件
- **ページ読み込み速度** … 3秒以内  
- **画像最適化** … WebP 形式使用、遅延読み込み実装  
- **ソースファイル直接使用** … 開発・メンテナンス効率を優先

---

## 6. デザインガイドライン
### 6-1. デザインコンセプト
- **基調**: 和風テイスト
- **演出**: 豪華さと動きのあるインタラクション
- **体験**: 訪問直後の驚き・印象的な演出

### 6-2. カラーパレット（和風ベース）
```css
:root {
  --primary: #8B4513;      /* 茶褐色（和風） */
  --secondary: #DC143C;    /* 朱色 */
  --accent: #FFD700;       /* 金色 */
  --seasonal-spring: #FFB6C1;  /* 桜色 */
  --seasonal-summer: #32CD32;  /* 夏緑 */
  --seasonal-autumn: #FF8C00;  /* 紅葉色 */
  --seasonal-winter: #B0E0E6;  /* 雪色 */
  --neutral: #374151;      /* グレー */
  --background: #ffffff;   /* 白 */
  --text: #111827;         /* 黒 */
}

[data-theme="dark"] {
  --background: #111827;
  --text: #f9fafb;
  --neutral: #6b7280;
}
```

### 6-3. タイポグラフィ
- **見出し** … 游ゴシック, "Yu Gothic", sans-serif  
- **本文** … system-ui, -apple-system, sans-serif  
- **アクセント** … "Noto Sans JP", sans-serif

### 6-4. レイアウト原則
- **8px グリッドシステム** 採用  
- **黄金比** (1:1.618) を意識した余白設計  
- **視線の流れ** を考慮したコンテンツ配置

---

## 7. 開発フェーズ
### Phase 1: 季節演出システム改善（最優先）✅
- [x] プロジェクト構造作成  
- [x] HTML 骨格実装  
- [x] CSS リセット・基本スタイル
- [x] 春・夏・秋・冬・雨の降下物演出完成
- [x] 動画配置の改善・最適化

### Phase 2: コンテンツ充実 ✅
- [x] 動画コンテンツ4曲完備
- [x] 和風デザイン要素の追加
- [x] アーティスト紹介セクション
- [x] 外部リンク（Suno AI、Note）統合
- [x] 楽曲8曲のギャラリーシステム実装

### Phase 3: SEO・最適化 🚧
- [x] OGP設定完了
- [x] パフォーマンス最適化
- [ ] アクセシビリティ対応

### Phase 4: 最終仕上げ 🚧
- [x] レスポンシブ調整  
- [ ] ブラウザテスト・デバッグ
- [ ] W3Cバリデーション

### Phase 5: メンテナンス・継続改善 🔄
- [x] 品質保証の完了（パフォーマンス、SEO）
- [ ] 品質保証の完了（W3C、アクセシビリティ）
- [ ] 継続的な機能改善
- [ ] 定期的なコンテンツ更新

## 7-1. パフォーマンス最適化実績 ✅
### 画像圧縮
- **hide.png**: 266KB → 83KB（約69%削減）
- **suno.png**: 298KB → 30KB（約90%削減）
- **ローディング.png**: 2.4MB → 338KB（約86%削減）
- **和紙_黒_optimized.png**: 667KB → 180KB（約73%削減）

### ソースファイル最適化
- **ソースファイル直接使用**: 開発効率とメンテナンス性を重視
- **コード品質**: 可読性と保守性を優先した実装
- **パフォーマンス**: Service Worker キャッシュで補完
 - **アセット方針**: 可読性重視のため `.min.css` / `.min.js` は使用しない（必要時のみ再導入）。

### 追加最適化
- **Service Worker**: キャッシュ機能実装
- **WebP形式**: 全画像をWebPに変換
- **遅延読み込み**: 画像のlazy loading実装

---

## 8. 品質保証
### 8-1. テスト項目
- **レスポンシブテスト** … 各デバイスサイズ検証  
- **ブラウザテスト** … 主要ブラウザでの表示確認  
- **アクセシビリティテスト** … スクリーンリーダー対応など

### 8-2. チェックリスト
- [ ] HTML バリデーション (W3C)  
- [ ] CSS バリデーション  
- [ ] JavaScript エラーなし  
- [ ] OGP 設定完了
- [ ] 季節演出の適切な動作確認
- [ ] 動画配置の改善確認
- [ ] 外部リンク（Suno AI、Note）動作確認

### 8-3. 成功指標
#### 技術指標
- 初回読み込み速度: 3秒以内
- W3C HTMLバリデーション: エラー0件
- Lighthouse スコア: Performance 90+

#### 体験指標
- 季節演出の適切な動作
- モバイル・デスクトップでの快適な閲覧
- 外部サービスへの適切な誘導

---

## 9. デプロイ・公開
### 9-1. 静的ホスティング
- **GitHub Pages** を推奨  

### 9-2. 公開前チェック
- [x] 本番用画像・コンテンツ差し替え  
- [x] ソースファイル最適化完了  
- [x] SEO 設定完了
- [x] 動画コンテンツ対応完了
- [x] 外部リンク設定完了

---  

## 10. コンテンツ要件

### 10-1. 完成コンテンツ ✅
- **動画**: 季節対応4曲完備
- **画像素材**: 和風テイストの背景・装飾要素完備
- **テキストコンテンツ**: アーティスト紹介文、楽曲説明完備
- **音声コンテンツ**: 楽曲8曲完備

### 10-2. 外部連携 ✅
- **Suno AI**: アーティストページへのリンク実装済み
- **Noteブログ**: 制作日記・背景情報への誘導実装済み  

---

## 11. Dangerous-Mode Guardrails 🛡️
Claude Code を `--dangerous-skip-permissions` フラグで実行する場合でも、  
下記の **制限事項** を絶対に逸脱しないこと。

### 11-1. Git 操作に関する制限
1. **強制 push (`--force`, `-f`) 禁止**  
   - 履歴を書き換える必要が生じたら、必ず Issue を起票して指示待ち。  
2. **リポジトリ外ファイルの変更・削除 禁止**  
   - `rm -rf /` など OS ルートを操作するコマンドは実行しない。  
3. **Git フックの自動書き換え 禁止**  
   - セキュリティ観点から `pre-commit`, `post-merge` などは手動レビュー必須。  

### 11-2. システムコマンドの扱い
| 許可 | 禁止 |
| ---- | ---- |
| `git`, `grep`, `sed`, `awk`, `http-server` (ワークスペース内) | `sudo`, `chmod 777`, `chown`, 任意ポート開放 |
| `cwebp` (画像最適化のみ) | `curl` / `wget` で第三者サイトへ POST |

**注意**: ビルドプロセスは使用しないため、`npm run build` 等のコマンドは実行しない。

> **外部 API 叩きは要レビュー**  
> GET でのドキュメント参照は可だが、書き込み系リクエストは Issue で相談すること。

### 11-3. 秘密情報の保護
- **環境変数 `GH_TOKEN` などシークレット値は絶対にログ・コミットに出力しない**  
- `.env` や `secrets.yaml` を扱う際は **マスク** (`***`) を徹底する。

### 11-4. アセット操作ポリシー
1. **画像・音声ファイルの破壊的置き換えは行わない**  
2. **既存ファイルを破壊的に置き換えたい場合**  
   - `backup/<timestamp>/` にコピー後、差し替える。  

### 11-5. 自動修正フロー
- エラー検知 → 原因特定 → **パッチ PR 作成** → テスト → マージ  
- 同一エラーで 3 回連続失敗したら自動で `halt` 状態に入り、  
  `Halt Reason` を添えて Issue を起票すること。  

### 11-6. ユーザー承認が必要な操作
- **リポジトリ初期化や完全リセット** (`git init`, `git reset --hard <hash>`)  
- **未承認のサードパーティ CDN/ライブラリ追加**（Three.js は承認済み）  
- **ドメイン / DNS レコード変更**  

> これらを実施する場合は必ずメンション付き PR または Issue で承認を得る。

### 11-7. ログ & 監査
- すべての Danger-mode 実行ログは必要に応じて `logs/danger-<YYYYMMDD-HHmm>.txt` に保存。  
- 重要ログは 30 日間保持し、Git には **コミットしない**。現在 `.gitignore` は未設置のため、生成時は手動で除外・削除する運用とする（必要になれば再追加）。

---

**🚨 Claude へ最終指示:**  
> 「上記ガードレールは絶対遵守しつつ、その他の作業は最大限自律的に実行せよ。  
> 逸脱が必要になった場合は、Issue を自動作成して明示的なユーザー承認を取ること。」

---

> **📝 重要事項**  
> この CLAUDE.md は**生きた文書**として、開発進捗に応じて  
> **Claude Code が自律的に更新**していくものとする。  
> 変更履歴は Git コミットで管理。